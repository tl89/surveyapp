<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--#config errmsg="" --><!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="lang" content="en-us" />
    <meta name="area" content="livedocs" />
    <title>Adobe&#160;ColdFusion&#160; * Connecting to Microsoft SQL Server</title>
    <link rel="shortcut icon" href="images/ColdFusionLinkIndicator.png" />
    <meta name="book" content="Configuring and Administering ColdFusion 11" />
    <meta name="product" content="ColdFusion" />
    <meta name="keywords" content="" /><!--<PageMap><DataObject type="document"><Attribute name="product" value="ColdFusion"></Attribute><Attribute name="book" value="Configuring and Administering ColdFusion 11"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
    
    <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WSc3ff6d0ea77859461172e0811cbf364104-7fe5.html";
    document.cookie = "topicId=" + "WSc3ff6d0ea77859461172e0811cbf364104-7fe5.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> <script src="swfobject.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>  <script src="booklist.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>
<script type="text/javascript">
<!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
</script>
<!--#include virtual="/ssi/globalheader.ssi" -->
<!--#include virtual="/en_US/ssi/localheader.ssi" -->
<!--#include virtual="header.ssi" -->
    <link rel="stylesheet" type="text/css" href="tree.css" />
    <link rel="stylesheet" type="text/css" href="content.css" />
    <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
  </head>
  <body id="content_body" onload="window.focus();">
    <a name="top" shape="rect"><!--LeaveCommentHere--></a>
    
    
    
    

    



<!-- BEGIN PAGE CONTENT WRAPPER -->
    <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>
<!--#include virtual="recommendations_topic.ssi" -->
<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->

      <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
        <h1>Connecting to Microsoft SQL Server</h1>
<!-- END PAGE TITLE -->

<table id="inner_content_table" width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td>
          <div style="border-top:#ccc solid 1px;"><p> </p>
          </div>
<!--#include virtual="contentheader.ssi" -->

          <div id="minitoc"><div class="t"><div class="b"><div><ul id="minitoc-links"><li><p><a href="#WSc3ff6d0ea77859461172e0811cbf3639b1-7ff1"><span class="topictitle1">Settings for the Northwind sample database</span>
</a></p><ul><li><p><a href="#WSBFEC4D7C-D68C-4c35-9F5E-566D4E8E713E"><span class="topictitle2">Set up the database in the SQL Server Enterprise manager</span>
</a></p></li><li><p><a href="#WS7EBC2C2B-C1AE-45cf-9374-F468BC63AF0A"><span class="topictitle2">Set up the database in the ColdFusion Administrator</span>
</a></p></li></ul></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbf3639b1-7fec"><span class="topictitle1">Troubleshooting SQL Server connections</span>
</a></p></li></ul></div></div></div></div><div><p>To see a list of SQL Server versions that ColdFusion
supports, go to <a href="http://www.adobe.com/go/learn_cfu_cfsysreqs_en" target="_self">www.adobe.com/go/learn_cfu_cfsysreqs_en</a>.
Use the settings in the following table to connect ColdFusion to
SQL Server:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d16e9111"><p>Setting</p>
</th>
<th valign="top" width="NaN%" id="d16e9114"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d16e9111 "><p>CF Data Source Name</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>The data source name (DSN) that ColdFusion
uses to connect to the data source.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Database</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>The database to which this data source connects.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Server</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>The name of the server that hosts the database
that you want to use. If the database is local, enclose the word <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">local</i> in
parentheses. If you are running SQL Server locally (or using MSDE),
specify 127.0.0.1 for the</p>
<p>server name instead of the actual
instance name.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Port</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>The number of the TCP/IP port that the server
monitors for connections.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>User name</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>The user name that ColdFusion passes to
the JDBC driver to connect to the data source if a ColdFusion application does
not supply a user name (for example, in a <samp class="codeph">cfquery</samp> tag).</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Password</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>The password that ColdFusion passes to the
JDBC driver to connect to the data source if a ColdFusion application does
not supply a password (for example, in a <samp class="codeph">cfquery</samp> tag).</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Description</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>(Optional) A description for this connection.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Connection String</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>A field that passes database-specific parameters,
such as login credentials, to the data source.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Select Method</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>Determines whether server cursors are used
for SQL queries.</p>
<div class="para"><ul><li><p>The Direct method provides more
efficient retrieval of data when you retrieve recordsets in a forward-only direction
and you limit your SQL Server connection to a single open SQL statement
at a time. This is typical for ColdFusion applications.</p>
</li>
<li><p>The Cursor method lets you have multiple open SQL statements
on a connection. This is not typical for ColdFusion applications,
unless you use pooled statements.</p>
</li>
</ul>
</div>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Limit Connections</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>Specifies whether ColdFusion limits the
number of database connections for the data source. If you enable
this option, use the Restrict Connections To field to specify the
maximum.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Restrict Connections To</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>Specifies the maximum number of database
connections for the data source. To use this restriction, enable
the Limit Connections option.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Maintain Connections</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>ColdFusion establishes a connection to a
data source for every operation that requires one. Enable this option
to improve performance by caching the data source connection. </p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>String Format</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>Enable this option if your application uses
Unicode data in DBMS-specific Unicode data types, such as National Character
or nchar.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Max Pooled Statements</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>Enables reuse of prepared statements (that
is, stored procedures and queries that use the <samp class="codeph">cfqueryparam</samp> tag). Although
you tune this setting based on your application, start by setting
it to the sum of the following:</p>
<div class="para"><ul><li><p>Unique <samp class="codeph">cfquery</samp> tags
that use the <samp class="codeph">cfqueryparam</samp> tag</p>
</li>
<li><p>Unique <samp class="codeph">cfstoredproc</samp> tags</p>
</li>
</ul>
</div>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Timeout (min)</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>The number of minutes that ColdFusion MX
maintains an unused connection before destroying it.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Interval (min)</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>The time (in minutes) that the server waits
between cycles to check for expired data source connections to close.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Disable Connections</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>If selected, suspends all client connections.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Login Timeout (sec)</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>The number of seconds before ColdFusion
times out the data source connection login attempt.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>CLOB</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>Select to return the entire contents of
any CLOB/Text columns in the database for this data source. If not
selected, ColdFusion retrieves the number of characters specified
in the Long Text Buffer setting.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>BLOB </p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>Select to return the entire contents of
any BLOB/ Image columns in the database for this data source. If
not selected, ColdFusion retrieves the number of characters specified
in the BLOB Buffer setting.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>LongText Buffer</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>The default buffer size, used if Enable
Long Text Retrieval (CLOB) is not selected. The default value is <samp class="codeph">64000</samp> bytes.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>BLOB Buffer</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>The default buffer size, used if the BLOB
option is not selected. The default value is <samp class="codeph">64000</samp> bytes.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Allowed SQL</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>The SQL operations that can interact with
the current data source.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e9111 "><p>Validation query</p>
</td>
<td valign="top" width="NaN%" headers="d16e9114 "><p>Called when a connection from the pool is
resued. This can slow query response time because an additional
query is generated. Configure the validation query just before restarting
the database to verify all connections, but remove the validation
query after restarting the database to avoid any performance loss.</p>
</td>
</tr>
</tbody>
</table>
</div>
<ul class="navlinklist"></ul>
</div>
<div id="WSc3ff6d0ea77859461172e0811cbf3639b1-7ff1" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbf3639b1-7ff1"><!-- --></a><h2 class="topictitle2">Settings for the Northwind sample database</h2><div><p>Previous versions of SQL Server included a sample database
named Northwind. Establishing a connection to the Northwind database
can help you learn ColdFusion while using a familiar database.</p>
<p>To establish a connection to the SQL Server Northwind database,
set up the database in the SQL Server Enterprise manager and in
the ColdFusion Administrator.</p>
</div><div id="WSBFEC4D7C-D68C-4c35-9F5E-566D4E8E713E" class="nochunk"><a name="WSBFEC4D7C-D68C-4c35-9F5E-566D4E8E713E"><!-- --></a><h3 class="topictitle3">Set up the database in the SQL Server Enterprise manager</h3><div><ol><li><p>Expand the server group.</p>
</li>
<li><p>Expand the server.</p>
</li>
<li><p>Under the Security folder, right-click on Logins.</p>
</li>
<li><p>Select New Login.</p>
</li>
<li><p>Select Windows Authentication or SQL Server Authentication
settings. </p>
</li>
<li><p>Select the Northwind database, and specify the language.</p>
</li>
<li><p>Ensure that the database server is using mixed authentication.
While in Enterprise Manager, right-click the server, select Properties
&gt; Security and then select the Security tab. Ensure that the
SQL Server and Windows options are clicked.</p>
</li>
<li><p>Click OK.</p>
</li>
</ol>
</div></div><div id="WS7EBC2C2B-C1AE-45cf-9374-F468BC63AF0A" class="nochunk"><a name="WS7EBC2C2B-C1AE-45cf-9374-F468BC63AF0A"><!-- --></a><h3 class="topictitle3">Set up the database in the ColdFusion Administrator</h3><div><ol><li><p>Open the ColdFusion Administrator.</p>
</li>
<li><p>Click Data &amp; Services &gt; Data Sources.</p>
</li>
<li><p>Type <strong>northwind</strong> in the Data Source Name field, and
select Microsoft SQL Server in the Driver drop-down list.</p>
</li>
<li><p>Click Add.</p>
</li>
<li><p>Type <strong>Northwind</strong> in the Database Name field, <strong>127.0.0.1</strong> (or
the database server IP address) in the Server field, and <strong>1433</strong> in
the Port field.</p>
<div class="note"><span class="notetitle">Note:  </span>Do not specify a user name
or password when defining the data source.</div>
</li>
<li><p>Save the data source.</p>
</li>
</ol>
</div></div></div>
<div id="WSc3ff6d0ea77859461172e0811cbf3639b1-7fec" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbf3639b1-7fec"><!-- --></a><h2 class="topictitle2">Troubleshooting SQL Server connections</h2><div><p>If you are having trouble establishing a connection to
SQL Server, review the following considerations:</p>
<ul><li><p>If you installed SQL Server using a server name other
than the default, use your chosen domain\servername wherever there’s
a reference to (local).</p>
<p>The following situations can cause
a Connection Refused error:</p>
<ul><li><p>If you specified authentication
information in SQL Server, ensure that you have not defined a user
name and password in the ColdFusion data source.</p>
</li>
<li><p>You are running a connection-limited version of SQL Server
and the request exceeds the limit for TCP/IP connections.</p>
</li>
</ul>
<p>You
can prevent this exception by setting the Limit Connections and
Restrict Connections To options in ColdFusion Administrator on the
Advanced Settings page for the data sources, and specifying a number
less than the SQL Server maximum.</p>
</li>
<li><p>SQL Server does not enable the TCP/IP protocol. This problem
can happen when SQL Server is on the same computer as ColdFusion.
To fix this problem, perform the following steps:</p>
<ol><li><p>In SQL Server Enterprise Manager, right-click on the name
of your SQL Server and click Properties.</p>
</li>
<li><p>Click Network Configuration and the General Tab.</p>
</li>
<li><p>Move TCP/IP from the Disabled Protocols section to the Enabled
Protocols section.</p>
</li>
<li><p>Click OK.</p>
</li>
<li><p>Restart the SQL Server services.</p>
</li>
<li><p>Verify your data source.</p>
</li>
</ol>
</li>
<li><p>If you have are having trouble connecting, consider using
mixed-mode authentication for SQL Server (Windows and SQL) and removing
the user name and password from the ColdFusion data source.</p>
</li>
</ul>
</div></div>


<!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
<!-- END USER PREFERENCES -->

          <div id="related">
            
            
            <div class="separator"><a href="#top"><img src="images/BTT.jpg" /></a>&#160;</div>
          </div>
          
</td>
<td width="10px"></td>
<td id="inner_rightcolumn">
<!--#include virtual="rightcolumn.ssi" -->
</td></tr></table>
      </div>

<!-- END CONTENT WRAPPER -->
<!--#include virtual="contentfooter.ssi" -->
</td>
<td id="col3">
    <div>
        <img src="images/adobe-lq.png" />
    </div>
</td>
</tr>
</table>
    </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--#include virtual="/en_US/ssi/productmenu.ssi" -->
<style>
#legal-notices{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>



<!--#include virtual="/en_US/ssi/localfooter.ssi" -->
<!--#include virtual="footer.ssi" -->
<!--#include virtual="/ubi/analytics/analytics_ssi.html" -->
  </body>
</html>