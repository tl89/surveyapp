/*! imslib.js 1.5.1+73b8e8e */

!function(a){a.adobeid=function(a){"use strict";var b;return"object"==typeof window.adobeid?b=window.adobeid:window.opener&&window.opener.adobeid?b=window.opener.adobeid:(b=window.adobeid={},a.logErrorToConsoleInDebugMode("Missing window.adobeid, falling back to an empty object")),b},a.alertMessages=function(){"use strict";return{dev:{adobeid:"Please declare the adobeid variable before loading the Javascript file for the IMS SDK",both_modal_and_redirect:"Error: you can't have both adobeid.uses_modal_mode and adobeid.uses_redirect_mode set to true.",client_id_missing:"Error: the ClientID is missing.",api_calls_only_https:"Error: the API calls must be made only through HTTPS.",mandatory_sign_in_only_in_redirect:"is_mandatory_sign_in only works in full web redirect mode.",scope_doesnt_ask_for_userId_from_profile:"The provided scopes don't ask for the userId from the user's profile",client_id_missing_from_query:'Please add the "#client_id#" to the comma separated list that is the client_id query parameter',load_the_sdk_only_once:"Please load the Javascript SDK only once."},user:{allow_pop_up_window:"The browser's pop-up blocker has stopped a window from opening. To be able to sign-in, please use the browser's UI (in the address bar) to allow the window to be opened. Thank you.",adobeid:"Please declare the adobeid variable before loading the Javascript file for the IMS SDK",api_calls_only_https:"Error: the API calls must be made only through HTTPS.",both_modal_and_redirect:"Error: you can't have both adobeid.uses_modal_mode and adobeid.uses_redirect_mode set to true.",client_id_missing:"Error: the ClientID is missing.",client_id_missing_from_query:'Please add the "#client_id#" to the comma separated list that is the client_id query parameter',load_the_sdk_only_once:"Please load the Javascript SDK only once.",mandatory_sign_in_only_in_redirect:"is_mandatory_sign_in only works in full web redirect mode.",scope_doesnt_ask_for_userId_from_profile:"The provided scopes don't ask for the userId from the user's profile",network_error:"A network error has occurred. Are you connected to the internet?"}}},a.config=function(b,c,d){"use strict";function e(){var a=d.getThisScriptSrc(),b=/\bclient_id=([^&]+)\b/.exec(a);return b?b[1].split(","):[]}function f(){var a=d.getThisScriptSrc(),b=/\blocale=([^&]+)\b/.exec(a);return b?b[1]:""}function g(){return c.client_id?c.client_id instanceof Array?c.client_id[0]:c.client_id:(d.logToConsoleInDebugMode("Missing window.adobeid.client_id. Falling back to client_id from url. Please add client_id to window.adobeid"),e()[0])}function h(){return c.locale?c.locale:(d.logToConsoleInDebugMode("Missing window.adobeid.locale. Falling back to locale from url. Please add locale to window.adobeid"),f())}var i=e();return i&&0!==i.length||(i=c.client_id),{sloEnabled:!0,refreshSsoCookiesEnabled:!1,sunbreakScope:"acct_mgmt_webui",sunbreakScopeExpanded:"acct_mgmt_api,gnav,update_profile.address.mail_to,update_profile.dob,update_profile.email,update_profile.first_name,update_profile.industry,update_profile.job_function,update_profile.job_title,update_profile.last_name,update_profile.mrktPerm,update_profile.password,update_profile.phoneNumber,update_profile.phonetic_name,update_profile.preferred_languages,update_profile.screen_name,update_profile.secondary_email",locale:h(),client_id:g(),api:a.config.$$api(b,i)}},a.config.$$api=function(a,b){"use strict";b instanceof Array||(b=[b]);var c={version:{v1:"v1"}};for(var d in a)if(a.hasOwnProperty(d)){var e=a[d],f={name:e.name,endpoint:{}};c[d]=f;for(var g=0,h=b.length;h>g;++g){var i=b[g];f.endpoint[i]=e.endpoint}}return c},a.events=function(a){"use strict";var b=function(){var b={};this.addEventListener=function(a,c){var d=b[a]||[];b[a]=d,d.push(c)},this.dispatchEvent=function(c,d){var e=b[c];if(e)for(var f={type:c,data:d},g=0,h=e.length;h>g;++g)a.callIfFunction(e[g],null,[f])}};return{EventTarget:b}},a.http=function(a){"use strict";var b=function(a){return JSON.stringify(a)},c=function(a){var c="",d=!0;for(var e in a)if(a.hasOwnProperty(e)&&void 0!==a[e]){var f,g=encodeURIComponent(e),h=a[e];f=null===h?"null":encodeURIComponent("object"==typeof h?b(h):h),c+=(d?"":"&")+g+"="+f,d=!1}return c},d=function(a,b){if(a){var d=c(a);return d&&(d=b&&-1!==b.indexOf("?")?"&"+d:"?"+d),d}return""},e="_adobeIMSJSONPCallbacks",f=function(b,c,f){c=c||{};var g=window[e];g||(g=window[e]={});var h="_"+a.createRandomString();c.callback="window."+e+"."+h,b+=d(c,b);var i=document.createElement("script");i.src=b,i.async=!0,i.type="text/javascript";var j=a.getDocumentHead();g[h]=function(b){a.isDebugMode&&a.logToConsole("api call response: "+JSON.stringify(b)),f(!1,b),a.removeKeyFromObject(g,h)};var k=function(){j.removeChild(i)};a.addEventListener(i,"load",k),a.addEventListener(i,"error",function(){f(!0,null),k()}),j.appendChild(i)},g={POST:"POST",GET:"GET"},h={JSON:"application/json",URI:"application/x-www-form-urlencoded"},i=function(){return XMLHttpRequest?"withCredentials"in new XMLHttpRequest:!1}(),j=function(a,b,c,d,e,f){var g=new XMLHttpRequest;if(g.onreadystatechange=function(){g.readyState===g.DONE&&f(g.status,g.responseText)},g.open(a.toUpperCase(),b,!0),e)for(var h in e)e.hasOwnProperty(h)&&g.setRequestHeader(h,e[h]);g.withCredentials=d,g.send(c)},k=function(a,b,c,e){a+=d(c,a),j(g.GET,a,null,!0,b,e)},l=function(a,d,e,f,i){if(d=d||{},e){switch(f){case h.JSON:e=b(e);break;case h.URI:e=c(e);break;default:throw new Error("Unknown encoding "+f)}d["Content-Type"]=f}j(g.POST,a,e,!0,d,i)},m=function(a,b,c,d,e,f){switch(e=e||h.URI,a.toUpperCase()){case g.GET:k(b,c,d,f);break;case g.POST:l(b,c,d,e,f);break;default:throw new Error("Unknown HTTP method "+a)}};return{buildQueryString:d,jsonp:f,corsGet:k,corsPost:l,cors:m,corsSupported:i,Method:g,DataEncoding:h}},a.imsApis=function(a,b,c,d,e){"use strict";function f(a){y=a}function g(){"function"==typeof y&&y.apply(null,arguments)}function h(a){if(!(a&&a.name&&c.api_parameters))return{};for(var d in c.api_parameters)if(b.String_contains(a.name,d))return c.api_parameters[d];return{}}function i(a,b){if(b&&b.client_id)return b.client_id;var d=h(a);return d&&d.client_id?d.client_id:c.client_id?c.client_id instanceof Array?c.client_id[0]:c.client_id:e}function j(a,d){var e="AdobeID,openid";if(d&&d.scope)e=d.scope;else{var f=h(a);f&&f.scope?e=f.scope:c.scope&&(e=c.scope)}return b.String_withoutWhitespaces(e)}function k(a,c,d){d||(d=i(a));var e=a.endpoint[d];return e?(c&&(e+="/"+c),e):(b.logToConsoleInDebugMode("No url found for api "+a.name+" for client "+d),"")}function l(b,c,d,e){!e&&d&&(e=d.client_id);var f=k(b,c,e);return f?f+a.buildQueryString(d,f):""}function m(){var b=c.optimizations&&!!c.optimizations.useCORS||!1;return a.corsSupported&&b}function n(c,d,e){var f=b.cloneObject(c.params)||{};f.client_id||(f.client_id=i(c.api));var g=k(c.api,c.apiVersion,c.params.client_id),h=c.method||a.Method.GET,j={};c.bearerToken&&(j.Authorization="Bearer "+c.bearerToken),a.cors(h,g,j,c.params,a.DataEncoding.URI,function(a,b){b?(b=JSON.parse(b),b.error_flag||b.error?e(b):d(b)):e(null)})}function o(c,d,e){var f=b.cloneObject(c.params),g=k(c.api,c.apiVersion,f.client_id);c.bearerToken&&(f.bearer_token=c.bearerToken),a.jsonp(g,f,function(a,b){a||b.error_flag||b.error?e(b):d(b)})}function p(a,b,c){if(!a)throw new Error("No config object provided");if(!a.api)throw new Error("No `config.api` provided");c=c||g,m()?n(a,b,c):o(a,b,c)}function q(c,e,f){var g=b.applyExtraApiParameters(h(d.validate_token),{token:c.access_token,client_id:c.client_id,"typeof":"access_token"});p({api:d.validate_token,params:g,method:a.Method.POST},e,f)}function r(c,e,f){var i=b.applyExtraApiParameters(h(d.logout_token),{access_token:c});f=f||g;var j=function(a){a&&a.error?f(a):e(a)};p({api:d.logout_token,method:a.Method.POST,params:i},j,j)}function s(a,e,f){var g=b.applyExtraApiParameters({client_id:i()},h(d.profile)),j=c.openidCompatible?d.userinfo:d.profile;p({api:j,bearerToken:a,params:g},e,f)}function t(a,c){var e=b.applyExtraApiParameters({client_id:i()},h(d.check_status));p({api:d.check_status,params:e},a,c)}function u(a,c,e){a=b.applyExtraApiParameters({client_id:i(),scope:j()},h(d.check),a),p({api:d.check,params:a},function(a){a.jump?e(a):c(a)},e)}function v(a){return k(d.avatar)+"/"+a}function w(a){return a=b.applyExtraApiParameters({response_type:"token",client_id:i(),scope:j()},h(d.authorize),a),l(d.authorize,null,a)}function x(a){return a=b.applyExtraApiParameters(h(d.logout),a),l(d.logout,null,a)}var y,z={getApiUrlWithQuery:l,getApiUrl:k,makeApiCall:p,validateToken:q,checkStatus:t,checkToken:u,getProfile:s,logoutToken:r,getAvatarUrl:v,getAuthorizeUrl:w,getLogoutUrl:x,apiEndpoints:d,getApiParameters:h,getClientId:i,getScope:j,setGlobalErrorHandler:f};return z},a.adobeIMS=function(a,b,c,d,e,f,g,h,i){"use strict";function j(a){return a?f.local:f.session}function k(){return f.session}function l(){return Boolean(b.optimizations&&b.optimizations.fastEvents)}function m(){var d=this;this.adobeid=b,!c.isDebugMode&&this.adobeid.uses_debug_mode&&(c.isDebugMode=!0),this._accessTokensInfos={},this._profile=null,this._is_already_attached_to_ui=!1,this._last_ui_update={_any_update_so_far:!1,_accessTokensInfos:{},_profile:null,update:function(){this._any_update_so_far=!0,this._accessTokensInfos=c.cloneObject(d._accessTokensInfos),this._profile=c.cloneObject(d._profile)},areThereUIUpdatesToPerformForAccessTokens:function(){return this._any_update_so_far?!c.equals(this._accessTokensInfos,d._accessTokensInfos):!0},areThereUIUpdatesToPerformForProfile:function(){return this._any_update_so_far?!c.equals(this._profile,d._profile):!0},areThereUIUpdatesToPerform:function(){return this.areThereUIUpdatesToPerformForProfile()||this.areThereUIUpdatesToPerformForAccessTokens()}},a.setGlobalErrorHandler(function(){d._onApiError.apply(d,arguments)})}function n(a,d){try{c.callIfFunction(b[a],b,d)}catch(e){this._onError(this.errors.jsException.setException(e,"adobeid."+a))}}var o="adobeid_ims_access_token",p="/",q="adobeid_ims_profile",r="from_ims",s=r+"=true",t="rctx",u="redirectims.html",v="ims_modal_window",w={sign_in:{width:600,height:700},sign_up:{width:600,height:850},sign_out:{width:320,height:240},jump:{width:600,height:850},any:{width:800,height:600}},x=null;if(window.adobeIMS)return c.logErrorToConsoleInDebugMode("adobeIMS already exists. Have you loaded the file twice?"),null;var y={PROFILE:"profile",ACCESS_TOKEN:"accesstoken",ACCESS_TOKEN_EXPIRED:"accesstokenexpired",READY:"ready",ERROR:"error"},z=new g.EventTarget,A=b.openidCompatible?"sub":"userId",B={Events:y,addEventListener:function(a,b){z.addEventListener(a,b)},IMSAPIs:{},errors:{network:{name:"networkError",userMessage:"Network error"},fromApiCallRedirect:{name:"fromApiCallRedirectError",userMessage:"",setMessage:function(a){return this.userMessage=a,this}},avatarPicture:{name:"avatarPictureError",userMessage:"current scopes won't retrieve the user_id"},jsException:{name:"jsExceptionError",message:"",exception:null,setException:function(a,b){return this.exception=a,this.message=b||"",this}}},getUrlForApiCall:function(b,c,d){return 2===arguments.length&&(d=arguments[1],c=null),a.getApiUrlWithQuery(b,c,d)},makeApiCall:function(b,c,d,e){return 3===arguments.length&&(e=arguments[2],d=arguments[1],c=null),a.makeApiCall({api:b,apiVersion:c,params:d,forceJsonp:!0},e)},_onApiError:function(a){var b=c.cloneObject(this.errors.network);b.debug={url:a,withJQuery:!!x},this._onError(b)},getUserProfile:function(){return this._profile},getUserPictureURL:function(){return this._profile?this._profile[A]?a.getAvatarUrl(this._profile[A]):(this._onError(this.errors.avatarPicture),""):""},getAccessTokenInfo:function(a,b,c){var d=this.getAccessTokenSessionStorageKey(a,b,c),e=this._accessTokensInfos[d];return e?j(e.isReAuthentication).getItem(d)?e:(this._clearCredentials({access_token:e.access_token}),null):null},getAccessToken:function(a,b,c){var d=this.getAccessTokenInfo(a,b,c);return d?d.access_token:null},getAccessTokenSessionStorageKey:function(a,b,c){return[o,b||this.getClientID(),Boolean(a),c||this.getScope()].join(p)},getKeyForAccessToken:function(a){for(var b in this._accessTokensInfos)if(a===this._accessTokensInfos[b].access_token)return b;return c.assert(!1,"unknown access_token for key: "+b),null},_isAccessTokenInfoUsable:function(a){return a&&"string"==typeof a.access_token&&"string"==typeof a.client_id&&this.isKnownClientID(a.client_id)&&"string"==typeof a.scope&&"boolean"==typeof a.isReAuthentication&&"number"==typeof a.expires_in&&"number"==typeof a.expiresAtMilliseconds&&c.Date_asMilliseconds()<a.expiresAtMilliseconds},loadFromStorage:function(){var a=this;this._accessTokensInfos={};var b=function(b){for(var d in b.keys?b.keys():b)if(c.String_startsWith(d,o))try{var e=c.parseJSON(b.getItem(d));if(!a.isKnownClientID(e.client_id))continue;a._isAccessTokenInfoUsable(e)?a._accessTokensInfos[d]=e:(c.logToConsoleInDebugMode("unusable access token info: "+b.getItem(d)),b.removeItem(d))}catch(f){b.removeItem(d)}};b(j(!1)),b(j(!0)),this._profile=c.parseJSON(k().getItem(q))},hasTokenButItHasExpired:function(a,b,d){var e=this.getAccessTokenInfo(a,b,d);return e&&c.Date_asMilliseconds()>e.expiresAtMilliseconds?e:void 0},isSignedInUser:function(a,b,d){var e=this.getAccessTokenInfo(a,b,d);return e&&c.Date_asMilliseconds()<e.expiresAtMilliseconds?e:void 0},signIn:function(b,d){this.contextToBePassedOnRedirect=d;var e=c.applyExtraApiParameters({locale:this.getLocale()},b);e.redirect_uri=this._getRedirectUri(i.api.authorize,e),this.version&&(e.jslibver=this.version);var f=a.getAuthorizeUrl(e);this.isModal()&&this._callCallbacksToUpdateUI(),this._openWindow(f,"create_account"===e.idp_flow?w.sign_up:w.sign_in)},reAuthenticate:function(a,b){var d=c.applyExtraApiParameters({reauth:"check",puser:this._profile&&this._profile.email?this._profile.email:void 0,eu:this._profile&&this._profile.email?"true":void 0},a);this.signIn(d,b)},isReAuthentication:function(a){return a&&a.reauth},updateRedirectUriForReAuthentication:function(a,b){return"string"==typeof a&&this.isReAuthentication(b)?(c.String_contains(a,"reauth=")||(a=a+"&reauth="+b.reauth),a):a},getContextFromRedirectForAccessToken:function(a){if(this.contextPassedFromRedirect&&this.contextPassedFromRedirect.access_token===a){var b=this.contextPassedFromRedirect.context;return this.contextPassedFromRedirect=null,b}return null},signUp:function(a,b){this.isModal()&&this._callCallbacksToUpdateUI(),this.signIn(c.applyExtraApiParameters({idp_flow:"create_account"},a),b)},_invalidateTokens:function(b,d){var e=this,f=b.length;f?c.each(b,function(b,g){a.logoutToken(e._accessTokensInfos[g].access_token,function(){--f,0===f&&c.callIfFunction(d)})}):c.callIfFunction(d)},signOut:function(b){function d(d){if(!d)return void e._clearCredentials({updateUI:!0});var f=c.applyExtraApiParameters(e.getAdobeIdApiParametersForApi(i.api.logout),b);e.isModal()&&f.redirect_uri&&e.switchToRedirectMode();var g=a.getLogoutUrl(c.applyExtraApiParameters({access_token:d.access_token,redirect_uri:e._getRedirectUri(e.config.api.logout,b)},f));e._clearCredentials({updateUI:!0}),e._openWindow(g,w.sign_out)}var e=this,f=c.Object_keys(this._accessTokensInfos);if(f.length){var g=this._accessTokensInfos[f.pop()];this._invalidateTokens(f,function(){d(g)})}else e._clearCredentials({updateUI:!0})},switchToRedirectMode:function(){this.adobeid.uses_modal_mode=!1,this.adobeid.uses_redirect_mode=!0},switchToModalMode:function(){this.adobeid.uses_modal_mode=!0,this.adobeid.uses_redirect_mode=!1},_clearCredentials:function(a){var b;if(a&&a.access_token)b=this.getKeyForAccessToken(a.access_token),j(!1).removeItem(b),j(!0).removeItem(b),c.removeKeyFromObject(this._accessTokensInfos,b);else{for(b in this._accessTokensInfos)if(c.String_startsWith(b,o)){var d=this._accessTokensInfos[b];j(d.isReAuthentication).removeItem(b)}this._accessTokensInfos={},k().removeItem(q),this._profile=null,this._clearTimerTestSSOCookieWillExpire()}a&&a.updateUI===!0&&this._callCallbacksToUpdateUI(a)},_callCallbacksToUpdateUI:function(a){if(this._last_ui_update.areThereUIUpdatesToPerform()){var b=c.cloneObject(this._last_ui_update);if(this._last_ui_update.update(),b.areThereUIUpdatesToPerformForProfile()&&z.dispatchEvent(y.PROFILE,{profile:this._profile}),b.areThereUIUpdatesToPerformForAccessTokens())if(a&&a.access_token){var d=this._accessTokensInfos[this.getKeyForAccessToken(a.access_token)];z.dispatchEvent(y.ACCESS_TOKEN,{accessTokenInfo:d})}else for(var e in this._accessTokensInfos)c.equals(this._accessTokensInfos[e],b._accessTokensInfos[e])||z.dispatchEvent(y.ACCESS_TOKEN,{accessTokenInfo:this._accessTokensInfos[e]})}},_onReady:function(){this.onReadyAlreadyCalled||(this.onReadyAlreadyCalled=!0,this._callCallbacksToUpdateUI(),z.dispatchEvent(y.READY))},isReady:function(){return!!this.onReadyAlreadyCalled},_onError:function(a){z.dispatchEvent(y.ERROR,{error:a}),"function"!=typeof this.adobeid.onError&&("string"==typeof a.userMessage?c.logToConsoleInDebugMode(a.userMessage):c.logErrorToConsoleInDebugMode("unhandled javascript error: "+JSON.stringify(a)),a.debug&&c.logToConsoleInDebugMode(JSON.stringify(a.debug)))},_update_url_ims_api:function(){if(this.adobeid.target_env){var a={replaceWhat:/https?:\/\/adobeid-na1-(dev|qa|stg)\d\.services\.adobe\.com/i,replaceWith:"https://adobeid-na1-"+this.adobeid.target_env+".services.adobe.com"},b={replaceWhat:/https?:\/\/ims-na1-(dev|qa|stg)\d\.adobelogin\.com/i,replaceWith:"https://ims-na1-"+this.adobeid.target_env+".adobelogin.com"},d=/https?:\/\/\S*\.corp\.adobe\.com(:\d*)?/i;for(var e in i.api){var f=i.api[e];if(!c.isEmptyObject(f.endpoint))for(var g in f.endpoint){var h=d.test(f.endpoint[g]);if(h){var j=c.String_contains(f.name,"check")||c.String_contains(f.name,"logout")?a:b;f.endpoint[g]=f.endpoint[g].replace(d,j.replaceWith)}else f.endpoint[g]=f.endpoint[g].replace(a.replaceWhat,a.replaceWith).replace(b.replaceWhat,b.replaceWith)}}c.isDebugMode&&(c.logToConsole("target_env = "+this.adobeid.target_env),c.logToConsole("authorize = "+i.api.authorize.endpoint[this.getClientID(i.api.authorize)]),c.logToConsole("check = "+i.api.check.endpoint[this.getClientID(i.api.check)]))}},_initialize:function(){var a=this;z.addEventListener(y.PROFILE,function(b){n.call(a,"onProfile",[b.data.profile])}),z.addEventListener(y.ACCESS_TOKEN,function(b){n.call(a,"onAccessToken",[b.data.accessTokenInfo.access_token,b.data.accessTokenInfo])}),z.addEventListener(y.READY,function(){n.call(a,"onReady")}),z.addEventListener(y.ERROR,function(a){c.callIfFunction(b.onError,b,[a.data.error])}),this._update_url_ims_api();var d=function(){a.isMandatorySignIn()&&!a.isSignedInUser()&&a.signIn()},e=function(){var b=c.cloneObject(a._accessTokensInfos||{}),e=function(){if(d(),a._callCallbacksToUpdateUI(),l()&&!a.isSignedInUser())for(var c in b)b.hasOwnProperty(c)&&b[c]&&z.dispatchEvent(y.ACCESS_TOKEN_EXPIRED,{accessTokenInfo:b[c]});a._onReady()};if(a.isSingleLogOutEnabled()||!a.isSignedInUser())a.signInBasedOnSingleSignOnSSO(e);else{var f=a.getAccessToken();c.removeKeyFromObject(b,a.getKeyForAccessToken(f)),a.testAccessTokenIsStillValid(f,e)}};l()&&(z.addEventListener(y.ACCESS_TOKEN_EXPIRED,function(b){n.call(a,"onAccessTokenHasExpired",[b.data.accessTokenInfo.access_token,b.data.accessTokenInfo])}),this.loadFromStorage(),c.isEmptyObject(this._profile)||this._callCallbacksToUpdateUI()),this._signInWhenRedirectedBackFromIMS(function(){a._isFinalRedirectPageInModalMode()?window.opener&&(window.opener.adobeIMS._importDataFromModalWindow(a),c.closeWindow()):(a.loadFromStorage(),a.hasJustReturnedFromAuthorize?this.isSignedInUser()?a._testAccessTokensAreStillValid():a.signInBasedOnSingleSignOnSSO(function(){a._testAccessTokensAreStillValid()}):a.isSignedInUser(!0)?a.testAccessTokenIsStillValid(a.getAccessToken(!0),e):e())})},_signInWhenRedirectedBackFromIMS:function(a){var b=this,e=c.getHashFromURL().substring(1);e=e.replace("%23expires_in","#expires_in").replace("%23error","#error").replace("?error","#error").replace("#","&");var f=c.getQueryParamsAsMap(e),g=f.access_token,h=f.api;h===i.api.authorize.name&&c.assert(g,"the authorize api must return an access_token");var j=Boolean(f.reauth),k=f.client_id||this.getClientID(),l=f.scope||this.getScope(),m=f.expires_in,n="true"===f[r],o=f.error,p=f[t];this.contextPassedFromRedirect=p?{context:c.parseJSON(p),access_token:g}:null;var q=g&&m||n&&h===i.api.logout.name||o&&n;return q?(d.setHash(f.old_hash||""),void(g?(this.hasJustReturnedFromAuthorize=!0,this._setAccessTokenAndGetProfile(g,j,k,l,m,null,function(){b.validateSSOCookieLifetime(g,a)})):(this._accessTokensInfos={},this._profile=null,o&&this._onError(this.errors.fromApiCallRedirect.setMessage(o)),a.call(this)))):void a.call(this)},_setAccessTokenAndGetProfile:function(b,d,e,f,g,h,i){var k=this;g=Number(g);var l=h&&h[A];if(this._removeAccessTokensIfDifferentUserId(l),c.isEmptyObject(this._accessTokensInfos)&&this.loadFromStorage(),!this.shouldAcceptTheToken(b,e,f,l,!0,d))return void c.callIfFunction(i,k);var m=this.getAccessTokenSessionStorageKey(d,e,f),n=c.Date_asMilliseconds();this._accessTokensInfos[m]={access_token:b,client_id:e,user_id:l,scope:f,expires_in:g,createdAtMilliseconds:n,expiresAtMilliseconds:n+g,isReAuthentication:d},j(d).setItem(m,JSON.stringify(this._accessTokensInfos[m])),this.onReadyAlreadyCalled&&this._callCallbacksToUpdateUI(),h?c.callIfFunction(i,k):a.getProfile(b,function(a){k.setProfile(a),c.callIfFunction(i,k)},function(a){c.logErrorToConsoleInDebugMode("Failed to retrieve the profile "+a),c.callIfFunction(i,k)})},setProfile:function(a){a&&!a.error_flag&&(this._profile=a,a?(k().setItem(q,JSON.stringify(this._profile)),this._removeAccessTokensIfDifferentUserId(a[A])):k().removeItem(q),this.onReadyAlreadyCalled&&this._callCallbacksToUpdateUI())},_removeAccessTokensIfDifferentUserId:function(a){if(a)for(var b in this._accessTokensInfos){var d=this._accessTokensInfos[b];d.user_id&&d.user_id!==a&&(this._clearCredentials({access_token:d.access_token,updateUI:!1}),c.isDebugMode&&c.logToConsole("remove token because of different user_id (isReAuthentication="+d.isReAuthentication+")"))}},_signInBasedOnStoredCredentials:function(a){this.loadFromStorage(),c.isEmptyObject(this._accessTokensInfos)?(this._clearCredentials(),c.callIfFunction(a,this)):this.hasJustReturnedFromAuthorize?(this.hasJustReturnedFromAuthorize=!1,c.callIfFunction(a)):this.testSingleLogOutSLO(a)},signInBasedOnSingleSignOnSSO:function(a){var b=this;this.acquireAccessToken(a,function(d){d.jump?(c.logToConsoleInDebugMode("jumping to "+d.jump),b._openWindow(d.jump,w.jump)):"ride_AdobeID_acct_evs"===d.error?(b._clearCredentials(),b.signIn()):"ride_AdobeID_acct_disabled"===d.error?b._invalidateTokens(c.Object_keys(b._accessTokensInfos),function(){b._clearCredentials({updateUI:!0}),b.signIn()}):(b._clearCredentials({updateUI:!0}),b.hasJustSingleLoggedOutSLO=!0,c.callIfFunction(a,b))})},acquireAccessToken:function(b,d){var e=this,f={client_id:a.getClientId(a.apiEndpoints.check),scope:a.getScope(a.apiEndpoints),locale:this.getLocale(),redirect_uri:this._getRedirectUri(a.apiEndpoints.check)};a.checkToken(f,function(a){var d=c.cloneObject(a);c.removeKeyFromObject(d,"access_token"),c.removeKeyFromObject(d,"expires_in"),c.removeKeyFromObject(d,"token_type"),e.setProfile(d),e._setAccessTokenAndGetProfile(a.access_token,!1,f.client_id,f.scope,a.expires_in,d,b)},d)},testSingleLogOutSLO:function(b){if(!this.isSingleLogOutEnabled())return void c.callIfFunction(b,this);var d=this;a.checkStatus(function(a){a.sso===!1&&a.remember_me===!1?(d._clearCredentials({updateUI:!0}),d.hasJustSingleLoggedOutSLO=!0,c.callIfFunction(b,d)):d.signInBasedOnSingleSignOnSSO(b)})},validateSSOCookieLifetime:function(a,b){c.callIfFunction(b,this)},_clearTimerTestSSOCookieWillExpire:function(){this._timerTestSSOCookieWillExpire&&(clearInterval(this._timerTestSSOCookieWillExpire),this._timerTestSSOCookieWillExpire=null)},shouldAcceptTheToken:function(a,b,d,e,f,g){var h=!0,j=[{shouldReject:f===!1,shouldLogToErrorConsole:!1,message:"access_token is invalid."},{shouldReject:f===!0&&e&&this._profile&&e!==this._profile[A],shouldLogToErrorConsole:!1,message:"access_token was from another userId (isReAuthentication=#0).".replace("#0",g)},{shouldReject:f===!0&&!this.isKnownClientID(b),shouldLogToErrorConsole:!0,message:"the #0 client_id associated with the access token is not for a known client_id (#1).".replace("#0",b).replace("#1",Object.keys?Object.keys(i.api.authorize.endpoint).join(","):this.getClientID())},{shouldReject:f===!0&&!this.matchesTheRequiredScope(d),shouldLogToErrorConsole:!0,message:"the (#0) scope associated with the access token doesn't match the required scope (#1).".replace("#0",d).replace("#1",this.getScope())},{shouldReject:!a,shouldLogToErrorConsole:!0,message:"no access token."}];return c.each(j,function(a,b){b.shouldReject&&(h=!1,(b.shouldLogToErrorConsole?c.logErrorToConsoleInDebugMode:c.logToConsoleInDebugMode)("shouldAcceptTheToken: "+b.message))}),h},testAccessTokenIsStillValid:function(b,d){var e=this,f=this._accessTokensInfos[this.getKeyForAccessToken(b)];c.assert(f,"we need token information to validate it");var g=function(a){if(a.token&&e.shouldAcceptTheToken(b,a.token.client_id,a.token.scope,a.token.user_id,a.valid,f.isReAuthentication))d();else{c.logToConsoleInDebugMode("validate/token: access_token is invalid. removing."),e._clearCredentials({updateUI:e.onReadyAlreadyCalled,access_token:b});try{a.token&&e.isKnownClientID(a.token.client_id)&&e.matchesTheRequiredScope(a.token.scope)&&c.callIfFunction(e.adobeid.onAccessTokenHasExpired,e.adobeid,[b,f])}catch(g){e._onError(e.errors.jsException.setException(g,"adobeid.onAccessTokenHasExpired"))}f.isReAuthentication?d():e.signInBasedOnSingleSignOnSSO(function(){e.isSignedInUser()||e.isMandatorySignIn()&&e.signIn(),d()})}};f&&this.isKnownClientID(f.client_id)?a.validateToken(f,g):g({valid:!1})},_testAccessTokensAreStillValid:function(){var a,b=0;for(a in this._accessTokensInfos)++b;var c=this,d=function(){--b,0===b&&c._onReady()};for(a in this._accessTokensInfos)c.testAccessTokenIsStillValid(this._accessTokensInfos[a].access_token,d)},_importDataFromModalWindow:function(a){if(c.isEmptyObject(a._accessTokensInfos))this._clearCredentials({updateUI:!0});else{this.contextPassedFromRedirect=c.cloneObject(a.contextPassedFromRedirect),c.equals(a._profile,this._profile)||c.isEmptyObject(a._profile)||this.setProfile(c.cloneObject(a._profile));for(var b in a._accessTokensInfos)if(!c.equals(a._accessTokensInfos[b],this._accessTokensInfos[b])){var d=c.cloneObject(a._accessTokensInfos[b]);this._accessTokensInfos[b]=d,j(d.isReAuthentication).setItem(b,JSON.stringify(d)),this.validateSSOCookieLifetime(this._accessTokensInfos[b].access_token)}this._callCallbacksToUpdateUI(),a.isSignedInUser(!0)&&!this.isSignedInUser(!1)&&this.signInBasedOnSingleSignOnSSO()}},_attachHandlersToUI:function(){c.logToConsoleInDebugMode("No-op: use the susiButtons module to automatically attach listeners to buttons")},_openWindow:function(a,b){if(this.isModal()){var e=Math.min(b&&b.width||w.any.width,screen.availWidth),f=Math.min(b&&b.height||w.any.height,screen.availHeight),g=parseInt((screen.availLeft?screen.availLeft:0)+Math.max(0,screen.availWidth-e)/2),h=parseInt((screen.availTop?screen.availTop:0)+Math.max(0,screen.availHeight-f)/2),i=c.openPopup(a,v,"width="+e+",height="+f+",left="+g+",top="+h+",toolbar=no,menubar=no");if(!i)return;"function"==typeof i.focus&&i.focus()}else d.setHref(a,this.isMandatorySignIn());this.contextToBePassedOnRedirect=null},isModal:function(){return this._isFinalRedirectPageInModalMode()?!0:this.adobeid.uses_modal_mode===!0&&this.adobeid.uses_redirect_mode===!0?(c.logErrorToConsoleInDebugMode("redirect mode and modal mode both enabled"),!0):"boolean"==typeof this.adobeid.uses_modal_mode?this.adobeid.uses_modal_mode:this.adobeid.uses_redirect_mode===!1},_isFinalRedirectPageInModalMode:function(){return c.String_contains(d.getHref(),u)&&window.opener&&window.opener!==window},getAdobeIdApiParametersForApi:function(b){return a.getApiParameters(b)},getLocale:function(){return this.adobeid.locale||i.locale},sunbreakHack:function(a){return a.replace(i.sunbreakScope,i.sunbreakScopeExpanded)},matchesTheRequiredScope:function(a){if(c.assert(c.String_hasContent(a),"scopeToValidate must be a non empty string for matchesTheRequiredScope"))return!1;var b=this.sunbreakHack(c.String_withoutWhitespaces(a)).split(","),d=!0;return c.each(this.sunbreakHack(this.getScope()).split(","),function(a,e){return c.existsInArray(e,b)?void 0:(d=!1,!1)}),d},getScope:function(b,c){return a.getScope(b,c)},isKnownClientID:function(a){return a in i.api.authorize.endpoint},getClientID:function(b,c){return a.getClientId(b,c)},isMandatorySignIn:function(){return this.adobeid.is_mandatory_sign_in===!0&&this.isModal()?(c.logErrorToConsoleInDebugMode("is_mandatory_sign_in can be enabled only in redirect mode"),!1):"boolean"==typeof this.adobeid.is_mandatory_sign_in?this.adobeid.is_mandatory_sign_in:!1},isSingleLogOutEnabled:function(){return"boolean"==typeof this.adobeid.uses_single_log_out?this.adobeid.uses_single_log_out:i.sloEnabled},isRefreshSSOCookiesEnabled:function(){return"boolean"==typeof this.adobeid.uses_refresh_sso_cookies?this.adobeid.uses_refresh_sso_cookies:i.refreshSsoCookiesEnabled},_getRedirectUri:function(a,b){var e="",f=c.applyExtraApiParameters(this.getAdobeIdApiParametersForApi(a),b);if(this.isModal())e=c.getBasePath(d.getHref())+u+"#"+s;else{e=f.redirect_uri?f.redirect_uri:this.adobeid.redirect_uri?this.adobeid.redirect_uri:d.getHref(),c.assert(!c.String_contains(e,r),"the redirect_uri mustn't already contain #from_ims");var g=c.getHashFromURL(e),h=e;g&&(h=h.substring(0,h.length-g.length)),e=h+"#"+s+"&old_hash="+encodeURIComponent(g)}return f.client_id&&(e+="&client_id="+encodeURIComponent(f.client_id)),f.scope&&(e+="&scope="+encodeURIComponent(f.scope)),a&&a.name&&(e+="&api="+encodeURIComponent(a.name)),e=this.updateRedirectUriForReAuthentication(e,f),c.isEmptyObject(this.contextToBePassedOnRedirect)||(e+="&"+t+"="+encodeURIComponent(JSON.stringify(this.contextToBePassedOnRedirect))),e},_ajaxGet:function(a,b,d){var f=this,g=function(d,e){if(d){var g=c.cloneObject(f.errors.network);g.debug={url:a,withJQuery:!!x},f._onError(g)}else b.call(f,e)};"jsonp"!==d&&e.corsSupported?e.corsGet(a,null,null,g):e.jsonp(a,{},g)},_handleTheJQueryDependency:function(){var a=this;h.onLoad(function(b){x=b.jQuery,a._initialize()})},_waitForDOMContentLoaded:function(){var a=this,b=!1,d=function(){b||(b=!0,a._handleTheJQueryDependency())};"complete"===document.readyState||"loaded"===document.readyState?d.call():(c.addEventListener(document,"DOMContentLoaded",d),c.addEventListener(window,"load",d))}};return m.call(B),B},a.location=function(){"use strict";function a(){return window.location.href}function b(a,b){b?window.location.replace(a):window.location.href=a}function c(){return window.location.hash}function d(a){window.location.hash=a}return{getHref:a,setHref:b,getHash:c,setHash:d}},a.optimizations=function(b,c){"use strict";if(b=b||{},b.enable!==!1)for(var d in a.optimizations)a.optimizations.hasOwnProperty(d)&&"function"==typeof a.optimizations[d]&&a.optimizations[d].call(null,b,c)},a.optimizations.$$prefetchSuSi=function(a,b){"use strict";if(a.prefetchSuSi!==!1){var c=function(){if(!b.isSignedInUser()){var a=b.getUrlForApiCall(b.config.api.authorize,{client_id:b.getClientID()}),c=/^(https?:\/\/.+?)\//.exec(a)[1],d=c+"/favicon.ico?cache_bust="+Math.random().toString(16).slice(2),e=document.createElement("link");e.setAttribute("rel","prefetch"),e.setAttribute("href",d),document.getElementsByTagName("head")[0].appendChild(e)}};b.isReady()?c():b.addEventListener(b.Events.READY,c)}},a.storage=function(b){"use strict";function c(c){if(a.storage.$$isPolyfillNeeded(c,b)){var d=a.storage.$$polyfill(b);return new d}return window[c]}function d(){return c("sessionStorage")}function e(){return c("localStorage");

}return{session:d(),local:e()}},a.storage.$$isPolyfillNeeded=function(a,b){"use strict";try{var c=window[a]}catch(d){return b.logToConsoleInDebugMode(a+" disabled"),!0}if(null===c||"undefined"==typeof c)return!0;try{return c.setItem("isStoragePolyfillNeeded",!0),"true"!==c.getItem("isStoragePolyfillNeeded")?!0:(c.removeItem("isStoragePolyfillNeeded"),!1)}catch(d){return!0}},a.storage.$$polyfill=function(a){"use strict";var b=function(){var b={};return{length:0,clear:function(){b={},this.length=0},getItem:function(a){var c=b[a];return"undefined"==typeof c?null:c},keys:function(){return b},removeItem:function(c){b.hasOwnProperty(c)&&(a.removeKeyFromObject(b,c),--this.length)},setItem:function(a,c){b.hasOwnProperty(a)||++this.length,b[a]=String(c)}}};return b},a.susiButtons=function(a,b,c){"use strict";function d(a){return document.querySelectorAll?document.querySelectorAll(a):g?g(a):[]}function e(a,c,e){var f=d(h.replace("%action%",a)),g=function(){c.call(e)};b.each(f,function(a,c){b.addEventListener(c,"click",g)})}function f(){var c=function(){i||(i=!0,e("signin",a.signIn,a),e("signup",a.signUp,a),e("signout",a.signOut,a),e("reauthenticate",a.reAuthenticate,a))};"complete"===window.document.readyState||"loaded"===window.document.readyState?c():(b.addEventListener(window.document,"DOMContentLoaded",c),b.addEventListener(window,"load",c))}var g;c&&c.onLoad(function(a){g=a.jQuery});var h='[data-adobeid-action="%action%"]',i=!1;return{attachListeners:f}},a.utils=function(a,b){"use strict";function c(a,b){if(I&&I.each)I.each.call(I,a,b);else for(var c=0;c<a.length&&b.call(a[c],c,a[c])!==!1;++c);}function d(a){return I?I(a)[0]:document.querySelector?document.querySelector(a):null}function e(){var a=d('script[src*="imslib.min.js"]');return a||(a=d('script[src*="imslib.js"]')),a?a.src:""}function f(a){window.console&&"function"==typeof window.console.log&&window.console.log("imslib.js: "+a)}function g(a){K&&f(a)}function h(a){K&&window.console&&"function"==typeof window.console.error&&window.console.error("imslib.js: "+a)}function i(a,b,c){return b>0?a.substring(0,b)+c+a.substring(b,a.length):c+a}function j(a,b){var c,d=-1;do c=d,d=a.indexOf(b,d+1);while(-1!==d);return c}function k(a,b){return-1!==a.indexOf(b)}function l(a,b){return 0===a.indexOf(b)}function m(a){return"string"==typeof a&&a.length>0}function n(a){return a.replace(/\s/g,"")}function o(a,b){return a||h("assert: "+b),!a}function p(a){return a||(a=new Date),o(a instanceof Date,"Date_asMilliseconds: provided date is not a Date.")?0:Number(a)}function q(a){return a&&"function"==typeof a}function r(a,b,c){return q(a)?a.apply(b,c||[]):void 0}function s(a,b){try{delete a[b]}catch(c){a[b]=void 0}}function t(a,b){if(null===a)return null===b;if(null===b)return null===a;if(typeof a!=typeof b)return!1;if(a instanceof Array){if(!(b instanceof Array)||a.length!==b.length)return!1;for(var c=0;c<a.length;++c)if(!t(a[c],b[c]))return!1;return!0}if("object"==typeof a){var d;for(d in a)if(!(d in b&&t(a[d],b[d])))return!1;for(d in b)if(!(d in a))return!1;return!0}return a===b}function u(a){if(null===a)return null;if("object"!=typeof a)return a;var b;if(a instanceof Array)return b=[],c(a,function(a,c){b.push(u(c))}),o(t(a,b),"cloned object has failed for "+JSON.stringify(a)),b;b={};for(var d in a)b[d]=u(a[d]);return o(t(a,b),"cloned object has failed for "+JSON.stringify(a)),b}function v(a){return!a||t(a,{})}function w(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}function x(){if(document.head)return document.head;var a=document.getElementsByTagName("head");return a&&a.length?a[0]:null}function y(a){return a.substring(0,j(a,"/")+1)}function z(a){a||(a=b.getHref());var c=a.indexOf("#");return-1!==c?a.substring(c):""}function A(a){a=a.replace(/^(#|\?|&)/,"");var b={};return c(a.split("&"),function(a,c){var d=c.split("=");b[d[0]]=decodeURIComponent(d[1])}),b}function B(a,b){for(var c=0;c<b.length;++c)if(t(b[c],a))return!0;return!1}function C(a,b,c){I?I(a).on(b,c):a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)}function D(a){return I?I.parseJSON(a):JSON.parse(a)}function E(a){for(var b=u(a),c=1;c<arguments.length;++c){var d=arguments[c];if("object"==typeof d)for(var e in d){var f=d[e];"undefined"!=typeof f?b[e]="object"!=typeof f?f:E(b[e]||{},f):s(b,e)}}return b}function F(a,b,c){return window.open(a,b,c)}function G(){window.close()}function H(){var a=Math.random().toString(16);return a.slice(a.indexOf(".")+1)}var I=null;a&&a.onLoad(function(a){I=a.jQuery});var J=e(),K=J.match(/^http(s:\/\/ims-na1-(dev|qa)\d\.adobelogin\.com)|(s?:\/\/[\w-]+\.(corp|eur)\.adobe\.com)|(s:\/\/adobeid-na1-(dev|qa)\d\.services\.adobe\.com)/i);K&&(J&&f("loaded from "+J),f("isDebugMode"));var L={isDebugMode:K,logToConsole:f,logToConsoleInDebugMode:g,logErrorToConsoleInDebugMode:h,assert:o,String_insert:i,String_lastIndexOf:j,String_contains:k,String_startsWith:l,String_hasContent:m,String_withoutWhitespaces:n,Date_asMilliseconds:p,isFunction:q,callIfFunction:r,removeKeyFromObject:s,cloneObject:u,equals:t,isEmptyObject:v,Object_keys:w,getDocumentHead:x,getBasePath:y,getHashFromURL:z,getQueryParamsAsMap:A,addEventListener:C,each:c,existsInArray:B,parseJSON:D,applyExtraApiParameters:E,openPopup:F,closeWindow:G,getThisScriptSrc:e,createRandomString:H};return L},a.vendors=function(){"use strict";var b={},c={jQuery:"https://static.adobelogin.com/renga-idprovider/resources/js/jquery-1.11.1.min.js",json:"https://static.adobelogin.com/renga-idprovider/resources/js/json2-min.js"},d=a.vendors.$$neededVendors(),e=function(a,b){var c=document.createElement("script");c.type="text/javascript",c.src=a,"function"==typeof b&&(c.onload=function(){window.setTimeout(b,1)});var d=document.head||document.getElementsByTagName("head")[0];d.appendChild(c)},f=function(a){e(c.json,a)},g=function(a){window.jQuery?a.call(null,window.jQuery):e(c.jQuery,function(){a.call(null,window.jQuery)})},h=!1;b.jQuery=null;var i=[],j=function(){var a=(d.isJQueryNeeded?!!b.jQuery:!0)&&(d.isJSONNeeded?h:!0);if(a)for(var c=i.shift();c;)c.call(null,b),c=i.shift()};return b.onLoad=function(a){i.push(a),window.setTimeout(j,0)},d.isJQueryNeeded&&g(function(a){b.jQuery=a,j()}),d.isJSONNeeded&&f(function(){h=!0,j()}),b},a.vendors.$$neededVendors=function(){"use strict";var a=function(){return!(window.JSON&&"function"==typeof window.JSON.stringify)}(),b=function(){if(!window.JSON||"function"!=typeof window.JSON.parse)return!0;if("function"!=typeof document.querySelectorAll)return!0;if(document.body){var a=document.createElement("div");a.setAttribute("data-isJqueryNeeded","no"),document.body.appendChild(a);var b=document.querySelectorAll('[data-isJqueryNeeded="no"]');return document.body.removeChild(a),1!==b.length}return!1}();return{isJQueryNeeded:b,isJSONNeeded:a}},a.bootstrap=function(){"use strict";var b=a.alertMessages(),c=a.vendors(),d=a.location(),e=a.utils(c,d),f=a.adobeid(e),g=a.storage(e),h=a.http(e),i=a.events(e),j=a.config(JSON.parse('{"authorize":{"name":"authorize","endpoint":"https://ims-na1.adobelogin.com/ims/authorize/v1"},"avatar":{"name":"avatar/download","endpoint":"https://ims-na1.adobelogin.com/ims/avatar/download"},"check":{"name":"check/token","endpoint":"https://adobeid-na1.services.adobe.com/ims/check/v1/token"},"check_status":{"name":"check/status","endpoint":"https://adobeid-na1.services.adobe.com/ims/check/v1/status"},"logout":{"name":"logout","endpoint":"https://adobeid-na1.services.adobe.com/ims/logout/v1"},"logout_token":{"name":"logout_token","endpoint":"https://ims-na1.adobelogin.com/ims/logout/v1/token"},"profile":{"name":"profile","endpoint":"https://ims-na1.adobelogin.com/ims/profile/v1"},"validate_token":{"name":"validate_token","endpoint":"https://ims-na1.adobelogin.com/ims/validate_token/v1"},"userinfo":{"name":"userinfo","endpoint":"https://ims-na1.adobelogin.com/ims/userinfo/v1"}}'),f,e),k=a.imsApis(h,e,f,j.api,j.client_id);window.adobeIMS=a.adobeIMS(k,f,e,d,h,g,i,c,j),window.adobeIMS.version="1.5.1";{var l=a.susiButtons(window.adobeIMS,e,c);a.optimizations(f.optimizations,window.adobeIMS)}window.adobeIMS.config=j,window.adobeIMS.IMSAPIs=j.api,window.AdobeIMSStrings=b,window.adobeIMS._handleTheJQueryDependency(),l.attachListeners()},a.bootstrap()}({});
//# sourceMappingURL=imslib.min.js.map