<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--#config errmsg="" --><!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="lang" content="en-us" />
    <meta name="area" content="livedocs" />
    <title>Adobe&#160;ColdFusion&#160; * Using the Server Monitor to improve server performance</title>
    <link rel="shortcut icon" href="images/ColdFusionLinkIndicator.png" />
    <meta name="book" content="Configuring and Administering ColdFusion 11" />
    <meta name="product" content="ColdFusion" />
    <meta name="keywords" content="" /><!--<PageMap><DataObject type="document"><Attribute name="product" value="ColdFusion"></Attribute><Attribute name="book" value="Configuring and Administering ColdFusion 11"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
    
    <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WSc3ff6d0ea77859461172e0811cbf363cdd-7fe2.html";
    document.cookie = "topicId=" + "WSc3ff6d0ea77859461172e0811cbf363cdd-7fe2.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> <script src="swfobject.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>  <script src="booklist.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>
<script type="text/javascript">
<!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
</script>
<!--#include virtual="/ssi/globalheader.ssi" -->
<!--#include virtual="/en_US/ssi/localheader.ssi" -->
<!--#include virtual="header.ssi" -->
    <link rel="stylesheet" type="text/css" href="tree.css" />
    <link rel="stylesheet" type="text/css" href="content.css" />
    <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
  </head>
  <body id="content_body" onload="window.focus();">
    <a name="top" shape="rect"><!--LeaveCommentHere--></a>
    
    
    
    

    



<!-- BEGIN PAGE CONTENT WRAPPER -->
    <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>
<!--#include virtual="recommendations_topic.ssi" -->
<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->

      <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
        <h1>Using the Server Monitor to improve server performance</h1>
<!-- END PAGE TITLE -->

<table id="inner_content_table" width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td>
          <div style="border-top:#ccc solid 1px;"><p> </p>
          </div>
<!--#include virtual="contentheader.ssi" -->

          <div id="minitoc"><div class="t"><div class="b"><div><ul id="minitoc-links"><li><p><a href="#WS46CC9F7C-FDAE-4980-B7EE-E39BAC71D450"><span class="topictitle1">Find bottlenecks in your application during development</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbf363cdd-7fde"><span class="topictitle1">JVM memory usage</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbf364104-7fb3"><span class="topictitle1">Variable memory usage</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbf364104-7fb5"><span class="topictitle1">Request handling</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbf364104-7fb6"><span class="topictitle1">Caching</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbf364104-7fb4"><span class="topictitle1">Database response time</span>
</a></p></li></ul></div></div></div></div><div><p>The Server Monitor provides information that you can use
to help improve the performance of your ColdFusion server. </p>
<ul class="navlinklist"></ul>
</div>
<div id="WS46CC9F7C-FDAE-4980-B7EE-E39BAC71D450" class="nochunk"><a name="WS46CC9F7C-FDAE-4980-B7EE-E39BAC71D450"><!-- --></a><h2 class="topictitle2">Find bottlenecks in your application during development</h2><div><ol><li><p>Turn on monitoring, profiling, and memory tracking.</p>
</li>
<li><p>Set the Slowest Request and Requests By Memory Usage report
thresholds to zero (0).</p>
</li>
<li><p>Run your templates.</p>
</li>
<li><p>For each request, find the following:</p>
<ul><li><p>The slowest
tags and functions in the Slowest Requests report.</p>
</li>
<li><p>The largest variables in the Requests By Memory Usage report.</p>
</li>
</ul>
</li>
</ol>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbf363cdd-7fde" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbf363cdd-7fde"><!-- --></a><h2 class="topictitle2">JVM memory usage</h2><div><p>Because ColdFusion is an enterprise Java application, the
Java Virtual Machine (JVM) is the software component that most influences
performance. Different JVMs from different vendors and different
versions of the same JVM from the same vendor have different performance
characteristics. You might benefit from changing the JVM that you
are using with ColdFusion. </p>
<p>ColdFusion contains an embedded version of Tomcat as the application
server and the Sun 1.6 version of the JVM. By contrast, ColdFusion
for J2EE running on IBM WebSphere Application Server uses the JVM
that WebSphere is configured to use. </p>
<p>To configure ColdFusion to use a different JVM, edit the <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">cf_root</i>/runtime/lib/jvm.config
file with a text editor by modifying the value of java.home to point
to the root directory of the JVM to use. Alternatively, you can switch
to a different JVM in the ColdFusion Administrator on the Java and
JVM Settings page.</p>
<p>Because switching the JVM changes the software environment significantly,
do so first in a development or testing environment. Also, fully
test your ColdFusion applications before you make the change on
a production server. </p>
<p>The JVM performs memory management and can have a significant
effect on your performance depending on how you configure the JVM.
The most important settings for the JVM are the initial heap size
and maximum heap size. The initial heap size represents the amount
of memory that the JVM uses on startup; the maximum heap size represents
the amount of memory that the JVM can use. You can modify these
settings in the ColdFusion Administrator on the Java and JVM Settings
page. The Initial Memory Size setting specifies the initial heap
size; the Maximum Memory Size setting specifies the maximum heap
size. The JVM arguments for initial heap size and maximum heap size
are -<samp class="codeph">XmsNm</samp> and <samp class="codeph">-XmxNm</samp> respectively,
where <samp class="codeph">N</samp> is the size of the heap in megabytes (MB).
These JVM arguments are stored in the jvm.config file, in the value
of the java.args setting.</p>
<p>The default maximum heap size is set to 512 MB in ColdFusion.
For best performance, set the initial heap size and the maximum
heap size to the same value. Determining the optimal size for the
heap to run the applications on your ColdFusion server results in
improved performance. Setting the value too high can result in poorer
performance because of the higher degree of garbage collection and
internal memory management required for the larger heap. Conversely,
setting the heap size too small can result in a java.lang.OutOfMemoryError
error if your application tries to use more memory than is available
to it. </p>
<p>The best way to find the optimal heap size is to run your application
under simulated peak load with a large heap and monitor how much
memory your application actually uses. If you find that your application
uses only 180 MB of memory, for example, you might see performance
benefit from reducing your heap size to 256 MB. </p>
<p>The java.lang.OutOfMemoryError error can occur in other, more
complicated, conditions. One common cause of the error is when objects
fill up the heap's permanent generation, which defaults to 64 MB.
You can increase the value, for example, to 128 MB, by adding the
following JVM argument to the Java and JVM Settings page of the
ColdFusion Administrator:</p>
<pre>-XX:MaxPermSize=128m.</pre>
<p>Physical hardware memory is an important consideration when determining
the optimal heap size. Setting the maximum heap size to a value
that exceeds the amount of free physical memory causes severe performance
degradation. For example, if you have only 512 MB of physical memory,
do not set the maximum heap size to 512 MB. Because the operating
system and other running applications use memory, much less than
512 MB of memory is available for the JVM process. it is important
to have hardware that meets the requirements of your software application.
For best results, run on server hardware with 1 GB or more of physical
memory.</p>
<p>The Server Monitor Summary page monitors the JVMâ€™s memory usage.
Use this information when determining the optimal heap size.</p>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbf364104-7fb3" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbf364104-7fb3"><!-- --></a><h2 class="topictitle2">Variable memory usage</h2><div><p>Configure client variable storage to use cookies or an
RDBMS for best performance when using client variables; you do this
on the Client Variables page of the ColdFusion Administrator.</p>
<p>Wherever possible, it is best to fully scope your variable names,
especially when using the <samp class="codeph">isdefined() </samp>function.
For example, <samp class="codeph">&lt;cfif isdefined("variables.myvariable")&gt;</samp> performs
much better than <samp class="codeph">&lt;cfif isdefined("myvariable")&gt;</samp>.</p>
<p>To monitor how variables use memory, view the reports in the <a href="WSc3ff6d0ea77859461172e0811cbf364104-7fb8.html">Memory Usage</a> of the Server Monitor.</p>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbf364104-7fb5" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbf364104-7fb5"><!-- --></a><h2 class="topictitle2">Request handling</h2><div><p>The Simultaneous Requests setting on the Settings page
of the ColdFusion Administrator has the largest effect on how well
an application performs under load. This setting dictates how many
threads are used to simultaneously process incoming requests. For
most applications, a good starting point for the optimal value for
this setting is three per processor; you can set a dual processor computer
to six simultaneous requests. To find the optimal value for this
setting, test your application under load with different values
until you find the value that provides the best performance under
load. While you test your application, you can view the average
response time on the Server Monitor Summary page and the reports
in <a href="WSc3ff6d0ea77859461172e0811cbf364104-7fba.html">Statistics</a>.</p>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbf364104-7fb6" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbf364104-7fb6"><!-- --></a><h2 class="topictitle2">Caching</h2><div><p>You can turn on the trusted-cache setting on the Caching
page of the ColdFusion Administrator for production applications
so that the server does not check the file system to see if the
CFML source code changed since it was last compiled. This setting
provides the benefit of minimizing system I/O, which has a major
effect on performance. Set the template-cache size on the Caching
page of the ColdFusion Administrator to be roughly equal to the
number of ColdFusion templates that are normally used. To monitor
how your settings affect performance, use the <a href="WSEE3AFBDC-AD1A-44dc-8E28-CC4273855B87.html">Template Cache Status</a> in the Request Statistics section of the Server
Monitor.</p>
<p>In addition, use one of the following methods to cache wherever
possible in your application:</p>
<ul><li><p>The <samp class="codeph">cfcache</samp> tag</p>
</li>
<li><p>Database query caching. Database caching can provide significant
performance and scalability improvements, and is accomplished with
the <samp class="codeph">cachedwithin</samp> and <samp class="codeph">cachedafter</samp> attributes
of database tags that support them, such as the <samp class="codeph">cfquery</samp> tag. </p>
</li>
<li><p>Storing data in persistent scopes such as session, making
it available for longer than a single request.</p>
</li>
</ul>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbf364104-7fb4" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbf364104-7fb4"><!-- --></a><h2 class="topictitle2">Database response time</h2><div><p>Wherever possible, it's best to allow database servers
to handle data manipulation. Adding SQL code to handle this work
is much more efficient than doing string manipulations or doing
in-memory queries (query of queries). Additionally, stored procedures
generally provide a higher level of performance than regular SQL
queries. Converting queries in <samp class="codeph">cfquery</samp> calls to
stored procedures and using the <samp class="codeph">cfstoredproc</samp> tag
typically improves performance. To view database response time information,
use the Database section of the Server Monitor (see <a href="WSc3ff6d0ea77859461172e0811cbf364104-7fb7.html">Database</a>).</p>
</div></div>


<!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
<!-- END USER PREFERENCES -->

          <div id="related">
            
            
            <div class="separator"><a href="#top"><img src="images/BTT.jpg" /></a>&#160;</div>
          </div>
          
</td>
<td width="10px"></td>
<td id="inner_rightcolumn">
<!--#include virtual="rightcolumn.ssi" -->
</td></tr></table>
      </div>

<!-- END CONTENT WRAPPER -->
<!--#include virtual="contentfooter.ssi" -->
</td>
<td id="col3">
    <div>
        <img src="images/adobe-lq.png" />
    </div>
</td>
</tr>
</table>
    </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--#include virtual="/en_US/ssi/productmenu.ssi" -->
<style>
#legal-notices{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>



<!--#include virtual="/en_US/ssi/localfooter.ssi" -->
<!--#include virtual="footer.ssi" -->
<!--#include virtual="/ubi/analytics/analytics_ssi.html" -->
  </body>
</html>